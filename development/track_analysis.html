

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>track_analysis &mdash; Testbeam Analysis 0.0.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/silab.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/banner.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Testbeam Analysis 0.0.1 documentation" href="index.html"/>
        <link rel="up" title="API" href="API.html"/>
        <link rel="next" title="result_analysis" href="result_analysis.html"/>
        <link rel="prev" title="dut_alignment" href="dut_alignment.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Testbeam Analysis
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="API.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hit_analysis.html">hit_analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="dut_alignment.html">dut_alignment</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">track_analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="result_analysis.html">result_analysis</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Testbeam Analysis</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="API.html">API</a> &raquo;</li>
        
      <li>track_analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/track_analysis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-testbeam_analysis.track_analysis">
<span id="track-analysis"></span><h1>track_analysis<a class="headerlink" href="#module-testbeam_analysis.track_analysis" title="Permalink to this headline">¶</a></h1>
<p>Track finding and fitting functions are listed here.</p>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="testbeam_analysis.track_analysis.find_tracks">
<code class="descclassname">testbeam_analysis.track_analysis.</code><code class="descname">find_tracks</code><span class="sig-paren">(</span><em>input_tracklets_file</em>, <em>input_alignment_file</em>, <em>output_track_candidates_file</em>, <em>min_cluster_distance=False</em>, <em>chunk_size=1000000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/testbeam_analysis/track_analysis.html#find_tracks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#testbeam_analysis.track_analysis.find_tracks" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes first DUT track hit and tries to find matching hits in subsequent DUTs.
The output is the same array with resorted hits into tracks. A track quality is set to
be able to cut on good (less scattered) tracks.
This function is uses numba to increase the speed on the inner loop (_find_tracks_loop()).</p>
<p>This function can also be called on TrackCandidates arrays. That is usefull if an additional alignment step
was done and the track finding has to be repeated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_tracklets_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Input file name with merged cluster hit table from all DUTs (tracklets file)
Or track candidates file.</li>
<li><strong>input_alignment_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; File containing the alignment information</li>
<li><strong>output_track_candidates_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Output file name for track candidate array</li>
<li><strong>min_cluster_distance</strong> (<em>iterable</em><em>, </em><em>boolean</em>) &#8211; A minimum distance all track cluster have to be apart, otherwise the complete event is flagged to have merged tracks (n_tracks = -1).
This is needed to get a correct efficiency number, since assigning the same cluster to several tracks is not implemented and error prone.
If it is true the std setting of 200 um is used. Otherwise a distance in um for each DUT has to be given.
e.g.: For two devices: min_cluster_distance = (50, 250)
If false the cluster distance is not considered.
The events where any plane does have hits &lt; min_cluster_distance is flagged with n_tracks = -1</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="testbeam_analysis.track_analysis.fit_tracks">
<code class="descclassname">testbeam_analysis.track_analysis.</code><code class="descname">fit_tracks</code><span class="sig-paren">(</span><em>input_track_candidates_file</em>, <em>input_alignment_file</em>, <em>output_tracks_file</em>, <em>fit_duts=None</em>, <em>selection_hit_duts=None</em>, <em>selection_fit_duts=None</em>, <em>exclude_dut_hit=True</em>, <em>selection_track_quality=1</em>, <em>max_tracks=None</em>, <em>force_prealignment=False</em>, <em>use_correlated=False</em>, <em>min_track_distance=False</em>, <em>chunk_size=1000000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/testbeam_analysis/track_analysis.html#fit_tracks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#testbeam_analysis.track_analysis.fit_tracks" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a line through selected DUT hits for selected DUTs. The selection criterion for the track candidates to fit is the track quality and the maximum number of hits per event.
The fit is done for specified DUTs only (fit_duts). This DUT is then not included in the fit (include_duts). Bad DUTs can be always ignored in the fit (ignore_duts).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_track_candidates_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Filename of the input track candidate file.</li>
<li><strong>input_alignment_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Filename of the input alignment file.</li>
<li><strong>output_tracks_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Filename of the output tracks file.</li>
<li><strong>fit_duts</strong> (<em>iterable</em>) &#8211; Specify DUTs for which tracks will be fitted. A track table will be generated for each fit DUT.
If None, all existing DUTs are used.</li>
<li><strong>selection_hit_duts</strong> (<em>iterable</em><em>, or </em><em>iterable of iterable</em>) &#8211; The duts that are required to have a hit with the given track quality. Otherwise the track is omitted.
If None: require all DUTs to have a hit, but if exclude_dut_hit = True do not use actual fit_dut.
If iterable: use selection for all devices, e.g.: Require hit in DUT 0, and 3: selection_hit_duts = (0, 3).
If iterable of iterable: define dut with hits for all devices seperately,
e.g. for 3 devices: selection_hit_duts = ((1, 2), (0, 1, 2), (0, 1))</li>
<li><strong>selection_fit_duts</strong> (<em>iterable</em><em>, or </em><em>iterable of iterable</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) &#8211; If None, selection_hit_duts are used for fitting.
Cannot define DUTs that are not in selection_hit_duts,
e.g. require hits in DUT0, DUT1, DUT3, DUT4 but do not use DUT3 in the fit:
selection_hit_duts = (0, 1, 3, 4)
selection_fit_duts = (0, 1, 4)</li>
<li><strong>exclude_dut_hit</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set to not require a hit in the actual fit DUT (e.g.: for unconstrained residuals).
False: Just use all devices as specified in selection_hit_duts.
True: Do not take the DUT hit for track selection / fitting, even if specified in selection_hit_duts.</li>
<li><strong>max_tracks</strong> (<em>uint</em>) &#8211; Take only events with tracks &lt;= max_tracks. If None, take any event.</li>
<li><strong>selection_track_quality</strong> (<em>uint</em><em>, </em><em>iterable</em>) &#8211; One number valid for all DUTs or an iterable with a number for each DUT.
0: All tracks with hits in DUT and references are taken
1: The track hits in DUT and reference are within 2-sigma of the correlation
2: The track hits in DUT and reference are within 1-sigma of the correlation
Track quality is saved for each DUT as boolean in binary representation. 8-bit integer for each &#8216;quality stage&#8217;, one digit per DUT.
E.g. 0000 0101 assigns hits in DUT0 and DUT2 to the corresponding track quality.</li>
<li><strong>pixel_size</strong> (<em>iterable of tuples</em>) &#8211; One tuple per DUT describing the pixel dimension (column/row),
e.g. for two FE-I4 DUTs [(250, 50), (250, 50)].</li>
<li><strong>use_correlated</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Use only events that are correlated. Can (at the moment) be applied only if function uses corrected Tracklets file.</li>
<li><strong>min_track_distance</strong> (<em>iterable</em><em>, </em><em>boolean</em>) &#8211; A minimum distance all track intersection at the DUT have to be apart, otherwise these tracks are deleted.
This is needed to get a correct efficiency number, since assigning the same cluster to several tracks is error prone and will not be implemented.
If it is true the std setting of 200 um is used. Otherwise a distance in um for each DUT has to be given.
e.g.: For two devices: min_track_distance = (50, 250)
If False, the minimum track distance is not considered.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="result_analysis.html" class="btn btn-neutral float-right" title="result_analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dut_alignment.html" class="btn btn-neutral" title="dut_alignment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, SiLab Bonn.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: development
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="track_analysis.html">development</a></dd>
        </dl>
    </div>
</div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>